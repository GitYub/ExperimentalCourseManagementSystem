<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>上传测试</title>
    <script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
</head>
<body>
<input id="file" type="file" name="file"/>
<br/>
<button id="upload" onclick="doUpload()">上传</button>
<progress id="progressBar" value="0" max="100"></progress>
<script>
    function doUpload() {
        var fileObj = document.getElementById("file").files[0]; // js 获取文件对象
        var FileController = "/upload";                    // 接收上传文件的后台地址

        // FormData 对象
        var form = new FormData();
        form.append("file",fileObj);

        // XMLHttpRequest 对象
        var xhr = new XMLHttpRequest();
        //为请求添加返回处理函数
        xhr.onreadystatechange=function () {
            if(this.readyState == 4 && this.status == 200){
                var b = this.responseText;
                if(b == "success"){
                    alert("上传成功！");
                }else{
                    alert("上传失败！");
                }
            }
        };
        xhr.open("post", FileController, true);
        //使用进度条记录上传进度
        xhr.upload.addEventListener("progress", progressFunction, false);
        xhr.send(form);
    }

    function progressFunction(evt) {
        var progressBar = document.getElementById("progressBar");
        var percentageDiv = document.getElementById("percentage");
        if (evt.lengthComputable) {
            progressBar.max = evt.total;
            progressBar.value = evt.loaded;
            percentageDiv.innerHTML = Math.round(evt.loaded / evt.total * 100) + "%";
        }
    }
</script>
</body>
</html>